2025-08-20T19:30:46.1089991Z ##[group]Run python -m pytest tests/unit -v \
2025-08-20T19:30:46.1090369Z [36;1mpython -m pytest tests/unit -v \[0m
2025-08-20T19:30:46.1090812Z [36;1m  --tb=short \[0m
2025-08-20T19:30:46.1091015Z [36;1m  --maxfail=5 \[0m
2025-08-20T19:30:46.1091216Z [36;1m  --cov=app \[0m
2025-08-20T19:30:46.1091424Z [36;1m  --cov-report=term-missing \[0m
2025-08-20T19:30:46.1091673Z [36;1m  --cov-report=xml \[0m
2025-08-20T19:30:46.1091907Z [36;1m  --cov-fail-under=50[0m
2025-08-20T19:30:46.1131684Z shell: /usr/bin/bash -e {0}
2025-08-20T19:30:46.1131905Z env:
2025-08-20T19:30:46.1132071Z   PYTHON_VERSION: 3.11
2025-08-20T19:30:46.1132268Z   WORKING_DIR: ./apps/api
2025-08-20T19:30:46.1132538Z   pythonLocation: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-20T19:30:46.1132938Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib/pkgconfig
2025-08-20T19:30:46.1133330Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-20T19:30:46.1133676Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-20T19:30:46.1134049Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-20T19:30:46.1134396Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib
2025-08-20T19:30:46.1135081Z   DATABASE_URL: ***localhost:5432/test_db
2025-08-20T19:30:46.1135369Z   REDIS_URL: redis://localhost:6379/0
2025-08-20T19:30:46.1135650Z   SECRET_KEY: test-secret-key-for-jwt-signing
2025-08-20T19:30:46.1135924Z   JWT_SECRET_KEY: test-secret-key
2025-08-20T19:30:46.1136140Z   JWT_ALGORITHM: HS256
2025-08-20T19:30:46.1136344Z   TWELVEDATA_API_KEY: test-key
2025-08-20T19:30:46.1136762Z   ENVIRONMENT: test
2025-08-20T19:30:46.1136944Z ##[endgroup]
2025-08-20T19:30:49.4749924Z ============================= test session starts ==============================
2025-08-20T19:30:49.4751059Z platform linux -- Python 3.11.13, pytest-7.4.4, pluggy-1.6.0 -- /opt/hostedtoolcache/Python/3.11.13/x64/bin/python
2025-08-20T19:30:49.4751970Z cachedir: .pytest_cache
2025-08-20T19:30:49.4753212Z benchmark: 5.0.1 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
2025-08-20T19:30:49.4754331Z rootdir: /home/runner/work/AI-Investment/AI-Investment/apps/api
2025-08-20T19:30:49.4754772Z configfile: pytest.ini
2025-08-20T19:30:49.4755286Z plugins: benchmark-5.0.1, Faker-37.5.3, cov-6.2.1, mock-3.14.1, env-1.1.3, anyio-4.10.0, dotenv-0.5.2, asyncio-0.23.8
2025-08-20T19:30:49.4755849Z asyncio: mode=Mode.STRICT
2025-08-20T19:30:49.8628178Z collecting ... collected 125 items
2025-08-20T19:30:49.8628552Z 
2025-08-20T19:30:49.9972218Z tests/unit/models/test_portfolio.py::TestPortfolioModel::test_portfolio_creation PASSED [  0%]
2025-08-20T19:30:50.0227926Z tests/unit/models/test_portfolio.py::TestPortfolioModel::test_portfolio_user_relationship PASSED [  1%]
2025-08-20T19:30:50.0447517Z tests/unit/models/test_portfolio.py::TestPortfolioModel::test_portfolio_default_values PASSED [  2%]
2025-08-20T19:30:50.0670571Z tests/unit/models/test_portfolio.py::TestPortfolioModel::test_portfolio_json_strategy_config PASSED [  3%]
2025-08-20T19:30:50.1011124Z tests/unit/models/test_portfolio.py::TestPortfolioModel::test_portfolio_updates PASSED [  4%]
2025-08-20T19:30:50.1273818Z tests/unit/models/test_portfolio.py::TestPortfolioModel::test_multiple_portfolios_per_user PASSED [  4%]
2025-08-20T19:30:50.1537673Z tests/unit/models/test_portfolio.py::TestPortfolioModel::test_portfolio_cascade_delete PASSED [  5%]
2025-08-20T19:30:50.2888192Z tests/unit/models/test_portfolio.py::TestPortfolioModel::test_portfolio_validation_constraints FAILED [  6%]
2025-08-20T19:30:50.3239860Z tests/unit/models/test_portfolio.py::TestPortfolioModel::test_portfolio_query_performance PASSED [  7%]
2025-08-20T19:30:50.8255454Z tests/unit/routers/test_auth.py::TestAuthEndpoints::test_register_new_user PASSED [  8%]
2025-08-20T19:30:51.1352867Z tests/unit/routers/test_auth.py::TestAuthEndpoints::test_register_duplicate_email PASSED [  8%]
2025-08-20T19:30:51.1720012Z tests/unit/routers/test_auth.py::TestAuthEndpoints::test_register_weak_password PASSED [  9%]
2025-08-20T19:30:51.7483341Z tests/unit/routers/test_auth.py::TestAuthEndpoints::test_login_valid_credentials PASSED [ 10%]
2025-08-20T19:30:52.3269941Z tests/unit/routers/test_auth.py::TestAuthEndpoints::test_login_invalid_password PASSED [ 11%]
2025-08-20T19:30:52.8509951Z tests/unit/routers/test_auth.py::TestAuthEndpoints::test_login_nonexistent_user FAILED [ 12%]
2025-08-20T19:30:53.3292824Z tests/unit/routers/test_auth.py::TestAuthEndpoints::test_login_inactive_user FAILED [ 12%]
2025-08-20T19:30:53.6663870Z tests/unit/routers/test_auth.py::TestAuthEndpoints::test_get_current_user ERROR [ 13%]
2025-08-20T19:30:53.7033253Z tests/unit/routers/test_auth.py::TestAuthEndpoints::test_get_current_user_no_token PASSED [ 14%]
2025-08-20T19:30:53.7392941Z tests/unit/routers/test_auth.py::TestAuthEndpoints::test_get_current_user_invalid_token PASSED [ 15%]
2025-08-20T19:30:54.0507988Z tests/unit/routers/test_auth.py::TestAuthEndpoints::test_get_current_user_expired_token FAILED [ 16%]
2025-08-20T19:30:54.0508797Z 
2025-08-20T19:30:54.0509000Z ==================================== ERRORS ====================================
2025-08-20T19:30:54.0509686Z __________ ERROR at setup of TestAuthEndpoints.test_get_current_user ___________
2025-08-20T19:30:54.0510325Z tests/conftest.py:122: in auth_headers
2025-08-20T19:30:54.0510906Z     access_token = create_access_token(data={"sub": test_user.email})
2025-08-20T19:30:54.0511535Z app/core/security.py:26: in create_access_token
2025-08-20T19:30:54.0512260Z     encoded_jwt = jwt.encode(to_encode, settings.SECRET_KEY, algorithm=settings.ALGORITHM)
2025-08-20T19:30:54.0513341Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pydantic/main.py:856: in __getattr__
2025-08-20T19:30:54.0514387Z     raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
2025-08-20T19:30:54.0515193Z E   AttributeError: 'Settings' object has no attribute 'ALGORITHM'
2025-08-20T19:30:54.0515966Z ------------------------------ Captured log setup ------------------------------
2025-08-20T19:30:54.0517200Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table prices does not exist, skipping index idx_price_asset_date
2025-08-20T19:30:54.0518457Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table prices does not exist, skipping index idx_price_date
2025-08-20T19:30:54.0519682Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table prices does not exist, skipping index idx_price_asset_id
2025-08-20T19:30:54.0520979Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table allocations does not exist, skipping index idx_allocation_date
2025-08-20T19:30:54.0522333Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table allocations does not exist, skipping index idx_allocation_asset_date
2025-08-20T19:30:54.0523708Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table index_values does not exist, skipping index idx_index_value_date
2025-08-20T19:30:54.0525230Z ERROR    app.utils.run_migrations:run_migrations.py:169 Google auth migration failed: (psycopg2.errors.UndefinedTable) relation "users" does not exist
2025-08-20T19:30:54.0526146Z 
2025-08-20T19:30:54.0526274Z [SQL: 
2025-08-20T19:30:54.0526739Z                 ALTER TABLE users 
2025-08-20T19:30:54.0527203Z                 ADD COLUMN is_google_user BOOLEAN DEFAULT FALSE
2025-08-20T19:30:54.0527668Z             ]
2025-08-20T19:30:54.0528114Z (Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-20T19:30:54.0528881Z ERROR    app.utils.run_migrations:run_migrations.py:188 Migration google_auth failed
2025-08-20T19:30:54.0529685Z WARNING  app.main:main.py:45 Some database migrations failed - check logs
2025-08-20T19:30:54.0530333Z =================================== FAILURES ===================================
2025-08-20T19:30:54.0531034Z ___________ TestPortfolioModel.test_portfolio_validation_constraints ___________
2025-08-20T19:30:54.0531917Z tests/unit/models/test_portfolio.py:304: in test_portfolio_validation_constraints
2025-08-20T19:30:54.0533072Z     with pytest.raises(Exception):  # Should raise IntegrityError
2025-08-20T19:30:54.0533900Z E   Failed: DID NOT RAISE <class 'Exception'>
2025-08-20T19:30:54.0534551Z ________________ TestAuthEndpoints.test_login_nonexistent_user _________________
2025-08-20T19:30:54.0535243Z   + Exception Group Traceback (most recent call last):
2025-08-20T19:30:54.0536280Z   |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py", line 87, in collapse_excgroups
2025-08-20T19:30:54.0537424Z   |     yield
2025-08-20T19:30:54.0538265Z   |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 190, in __call__
2025-08-20T19:30:54.0539298Z   |     async with anyio.create_task_group() as task_group:
2025-08-20T19:30:54.0540319Z   |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
2025-08-20T19:30:54.0541264Z   |     raise BaseExceptionGroup(
2025-08-20T19:30:54.0541838Z   | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
2025-08-20T19:30:54.0542438Z   +-+---------------- 1 ----------------
2025-08-20T19:30:54.0542866Z     | Traceback (most recent call last):
2025-08-20T19:30:54.0543745Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/_pytest/runner.py", line 341, in from_call
2025-08-20T19:30:54.0544656Z     |     result: Optional[TResult] = func()
2025-08-20T19:30:54.0545085Z     |                                 ^^^^^^
2025-08-20T19:30:54.0545917Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/_pytest/runner.py", line 262, in <lambda>
2025-08-20T19:30:54.0547062Z     |     lambda: ihook(item=item, **kwds), when=when, reraise=reraise
2025-08-20T19:30:54.0547596Z     |             ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0548440Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_hooks.py", line 512, in __call__
2025-08-20T19:30:54.0549515Z     |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
2025-08-20T19:30:54.0550190Z     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0551075Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_manager.py", line 120, in _hookexec
2025-08-20T19:30:54.0552005Z     |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
2025-08-20T19:30:54.0552563Z     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0553448Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 167, in _multicall
2025-08-20T19:30:54.0554329Z     |     raise exception
2025-08-20T19:30:54.0555153Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 139, in _multicall
2025-08-20T19:30:54.0556060Z     |     teardown.throw(exception)
2025-08-20T19:30:54.0557192Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
2025-08-20T19:30:54.0558190Z     |     return result.get_result()
2025-08-20T19:30:54.0558590Z     |            ^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0559445Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_result.py", line 103, in get_result
2025-08-20T19:30:54.0560338Z     |     raise exc.with_traceback(tb)
2025-08-20T19:30:54.0561307Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
2025-08-20T19:30:54.0562257Z     |     res = yield
2025-08-20T19:30:54.0562577Z     |           ^^^^^
2025-08-20T19:30:54.0563381Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 139, in _multicall
2025-08-20T19:30:54.0564534Z     |     teardown.throw(exception)
2025-08-20T19:30:54.0565704Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
2025-08-20T19:30:54.0566927Z     |     return result.get_result()
2025-08-20T19:30:54.0567330Z     |            ^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0568167Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_result.py", line 103, in get_result
2025-08-20T19:30:54.0569059Z     |     raise exc.with_traceback(tb)
2025-08-20T19:30:54.0570012Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
2025-08-20T19:30:54.0570963Z     |     res = yield
2025-08-20T19:30:54.0571280Z     |           ^^^^^
2025-08-20T19:30:54.0572047Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 139, in _multicall
2025-08-20T19:30:54.0572952Z     |     teardown.throw(exception)
2025-08-20T19:30:54.0573920Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
2025-08-20T19:30:54.0574898Z     |     return result.get_result()
2025-08-20T19:30:54.0575283Z     |            ^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0576101Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_result.py", line 103, in get_result
2025-08-20T19:30:54.0577146Z     |     raise exc.with_traceback(tb)
2025-08-20T19:30:54.0578100Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
2025-08-20T19:30:54.0579051Z     |     res = yield
2025-08-20T19:30:54.0579358Z     |           ^^^^^
2025-08-20T19:30:54.0580135Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 139, in _multicall
2025-08-20T19:30:54.0581043Z     |     teardown.throw(exception)
2025-08-20T19:30:54.0581981Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
2025-08-20T19:30:54.0582965Z     |     return result.get_result()
2025-08-20T19:30:54.0583354Z     |            ^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0584169Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_result.py", line 103, in get_result
2025-08-20T19:30:54.0585058Z     |     raise exc.with_traceback(tb)
2025-08-20T19:30:54.0586030Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
2025-08-20T19:30:54.0587170Z     |     res = yield
2025-08-20T19:30:54.0587483Z     |           ^^^^^
2025-08-20T19:30:54.0588241Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 139, in _multicall
2025-08-20T19:30:54.0589139Z     |     teardown.throw(exception)
2025-08-20T19:30:54.0590075Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
2025-08-20T19:30:54.0591053Z     |     return result.get_result()
2025-08-20T19:30:54.0591438Z     |            ^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0592263Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_result.py", line 103, in get_result
2025-08-20T19:30:54.0593149Z     |     raise exc.with_traceback(tb)
2025-08-20T19:30:54.0594083Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
2025-08-20T19:30:54.0595006Z     |     res = yield
2025-08-20T19:30:54.0595303Z     |           ^^^^^
2025-08-20T19:30:54.0596068Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 139, in _multicall
2025-08-20T19:30:54.0597383Z     |     teardown.throw(exception)
2025-08-20T19:30:54.0598345Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
2025-08-20T19:30:54.0599544Z     |     return result.get_result()
2025-08-20T19:30:54.0599930Z     |            ^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0600752Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_result.py", line 103, in get_result
2025-08-20T19:30:54.0601644Z     |     raise exc.with_traceback(tb)
2025-08-20T19:30:54.0602587Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
2025-08-20T19:30:54.0603530Z     |     res = yield
2025-08-20T19:30:54.0603833Z     |           ^^^^^
2025-08-20T19:30:54.0604584Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 121, in _multicall
2025-08-20T19:30:54.0605460Z     |     res = hook_impl.function(*args)
2025-08-20T19:30:54.0605877Z     |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0606917Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/_pytest/runner.py", line 177, in pytest_runtest_call
2025-08-20T19:30:54.0607828Z     |     raise e
2025-08-20T19:30:54.0608622Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/_pytest/runner.py", line 169, in pytest_runtest_call
2025-08-20T19:30:54.0609509Z     |     item.runtest()
2025-08-20T19:30:54.0610299Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/_pytest/python.py", line 1792, in runtest
2025-08-20T19:30:54.0611231Z     |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
2025-08-20T19:30:54.0612135Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_hooks.py", line 512, in __call__
2025-08-20T19:30:54.0613178Z     |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
2025-08-20T19:30:54.0613769Z     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0614582Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_manager.py", line 120, in _hookexec
2025-08-20T19:30:54.0615558Z     |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
2025-08-20T19:30:54.0616086Z     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0617071Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 167, in _multicall
2025-08-20T19:30:54.0617854Z     |     raise exception
2025-08-20T19:30:54.0618559Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 139, in _multicall
2025-08-20T19:30:54.0619327Z     |     teardown.throw(exception)
2025-08-20T19:30:54.0620137Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
2025-08-20T19:30:54.0620970Z     |     return result.get_result()
2025-08-20T19:30:54.0621308Z     |            ^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0622034Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_result.py", line 103, in get_result
2025-08-20T19:30:54.0622803Z     |     raise exc.with_traceback(tb)
2025-08-20T19:30:54.0623632Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
2025-08-20T19:30:54.0624447Z     |     res = yield
2025-08-20T19:30:54.0624712Z     |           ^^^^^
2025-08-20T19:30:54.0625348Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pluggy/_callers.py", line 121, in _multicall
2025-08-20T19:30:54.0626117Z     |     res = hook_impl.function(*args)
2025-08-20T19:30:54.0626845Z     |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0627618Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/_pytest/python.py", line 194, in pytest_pyfunc_call
2025-08-20T19:30:54.0628624Z     |     result = testfunction(**testargs)
2025-08-20T19:30:54.0628984Z     |              ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0629851Z     |   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/routers/test_auth.py", line 103, in test_login_nonexistent_user
2025-08-20T19:30:54.0630718Z     |     response = client.post(
2025-08-20T19:30:54.0631036Z     |                ^^^^^^^^^^^^
2025-08-20T19:30:54.0631756Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/testclient.py", line 633, in post
2025-08-20T19:30:54.0632503Z     |     return super().post(
2025-08-20T19:30:54.0632811Z     |            ^^^^^^^^^^^^^
2025-08-20T19:30:54.0633467Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/httpx/_client.py", line 1145, in post
2025-08-20T19:30:54.0634192Z     |     return self.request(
2025-08-20T19:30:54.0634507Z     |            ^^^^^^^^^^^^^
2025-08-20T19:30:54.0635224Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/testclient.py", line 516, in request
2025-08-20T19:30:54.0635996Z     |     return super().request(
2025-08-20T19:30:54.0636314Z     |            ^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0637155Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/httpx/_client.py", line 827, in request
2025-08-20T19:30:54.0638033Z     |     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2025-08-20T19:30:54.0638553Z     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0639296Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/httpx/_client.py", line 914, in send
2025-08-20T19:30:54.0640050Z     |     response = self._send_handling_auth(
2025-08-20T19:30:54.0640433Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0641217Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/httpx/_client.py", line 942, in _send_handling_auth
2025-08-20T19:30:54.0642052Z     |     response = self._send_handling_redirects(
2025-08-20T19:30:54.0642431Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0643238Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
2025-08-20T19:30:54.0644087Z     |     response = self._send_single_request(request)
2025-08-20T19:30:54.0644480Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0645276Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/httpx/_client.py", line 1015, in _send_single_request
2025-08-20T19:30:54.0646120Z     |     response = transport.handle_request(request)
2025-08-20T19:30:54.0646654Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0647459Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/testclient.py", line 398, in handle_request
2025-08-20T19:30:54.0648226Z     |     raise exc
2025-08-20T19:30:54.0648925Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/testclient.py", line 395, in handle_request
2025-08-20T19:30:54.0649761Z     |     portal.call(self.app, scope, receive, send)
2025-08-20T19:30:54.0650506Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anyio/from_thread.py", line 291, in call
2025-08-20T19:30:54.0651346Z     |     return cast(T_Retval, self.start_task_soon(func, *args).result())
2025-08-20T19:30:54.0651819Z     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0652526Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/concurrent/futures/_base.py", line 456, in result
2025-08-20T19:30:54.0653413Z     |     return self.__get_result()
2025-08-20T19:30:54.0653904Z     |            ^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0654590Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
2025-08-20T19:30:54.0655315Z     |     raise self._exception
2025-08-20T19:30:54.0656039Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anyio/from_thread.py", line 222, in _call_func
2025-08-20T19:30:54.0656989Z     |     retval = await retval_or_awaitable
2025-08-20T19:30:54.0657359Z     |              ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0658120Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
2025-08-20T19:30:54.0658938Z     |     await super().__call__(scope, receive, send)
2025-08-20T19:30:54.0659768Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
2025-08-20T19:30:54.0660643Z     |     await self.middleware_stack(scope, receive, send)
2025-08-20T19:30:54.0661522Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
2025-08-20T19:30:54.0662321Z     |     raise exc
2025-08-20T19:30:54.0663050Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
2025-08-20T19:30:54.0663922Z     |     await self.app(scope, receive, _send)
2025-08-20T19:30:54.0664754Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/cors.py", line 85, in __call__
2025-08-20T19:30:54.0665573Z     |     await self.app(scope, receive, send)
2025-08-20T19:30:54.0666565Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
2025-08-20T19:30:54.0667374Z     |     with collapse_excgroups():
2025-08-20T19:30:54.0667986Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/contextlib.py", line 158, in __exit__
2025-08-20T19:30:54.0668657Z     |     self.gen.throw(typ, value, traceback)
2025-08-20T19:30:54.0669469Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
2025-08-20T19:30:54.0670318Z     |     raise exc
2025-08-20T19:30:54.0671025Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
2025-08-20T19:30:54.0671916Z     |     response = await self.dispatch_func(request, call_next)
2025-08-20T19:30:54.0672352Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0673008Z     |   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 88, in dispatch
2025-08-20T19:30:54.0673707Z     |     response = await call_next(request)
2025-08-20T19:30:54.0674067Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0674878Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
2025-08-20T19:30:54.0675686Z     |     raise app_exc
2025-08-20T19:30:54.0676538Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
2025-08-20T19:30:54.0677452Z     |     await self.app(scope, receive_or_disconnect, send_no_error)
2025-08-20T19:30:54.0678329Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
2025-08-20T19:30:54.0679130Z     |     with collapse_excgroups():
2025-08-20T19:30:54.0679769Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/contextlib.py", line 158, in __exit__
2025-08-20T19:30:54.0680455Z     |     self.gen.throw(typ, value, traceback)
2025-08-20T19:30:54.0681453Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
2025-08-20T19:30:54.0682410Z     |     raise exc
2025-08-20T19:30:54.0683151Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
2025-08-20T19:30:54.0684039Z     |     response = await self.dispatch_func(request, call_next)
2025-08-20T19:30:54.0684478Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0685116Z     |   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 138, in dispatch
2025-08-20T19:30:54.0685788Z     |     response = await call_next(request)
2025-08-20T19:30:54.0686155Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0687112Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
2025-08-20T19:30:54.0687948Z     |     raise app_exc
2025-08-20T19:30:54.0688666Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
2025-08-20T19:30:54.0689557Z     |     await self.app(scope, receive_or_disconnect, send_no_error)
2025-08-20T19:30:54.0690502Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 65, in __call__
2025-08-20T19:30:54.0691506Z     |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-08-20T19:30:54.0692502Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
2025-08-20T19:30:54.0693304Z     |     raise exc
2025-08-20T19:30:54.0694070Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
2025-08-20T19:30:54.0694914Z     |     await app(scope, receive, sender)
2025-08-20T19:30:54.0695664Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 756, in __call__
2025-08-20T19:30:54.0696661Z     |     await self.middleware_stack(scope, receive, send)
2025-08-20T19:30:54.0697458Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 776, in app
2025-08-20T19:30:54.0698225Z     |     await route.handle(scope, receive, send)
2025-08-20T19:30:54.0698991Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 297, in handle
2025-08-20T19:30:54.0699756Z     |     await self.app(scope, receive, send)
2025-08-20T19:30:54.0700495Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 77, in app
2025-08-20T19:30:54.0701362Z     |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-08-20T19:30:54.0702359Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 75, in wrapped_app
2025-08-20T19:30:54.0703223Z     |     response = await handler(conn, exc)
2025-08-20T19:30:54.0703588Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0704333Z     |   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 179, in validation_exception_handler
2025-08-20T19:30:54.0705099Z     |     response = JSONResponse(
2025-08-20T19:30:54.0705419Z     |                ^^^^^^^^^^^^^
2025-08-20T19:30:54.0706146Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 184, in __init__
2025-08-20T19:30:54.0707206Z     |     super().__init__(content, status_code, headers, media_type, background)
2025-08-20T19:30:54.0708093Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 41, in __init__
2025-08-20T19:30:54.0709072Z     |     self.body = self.render(content)
2025-08-20T19:30:54.0709432Z     |                 ^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0710352Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 187, in render
2025-08-20T19:30:54.0711127Z     |     return json.dumps(
2025-08-20T19:30:54.0711424Z     |            ^^^^^^^^^^^
2025-08-20T19:30:54.0712002Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/__init__.py", line 238, in dumps
2025-08-20T19:30:54.0712633Z     |     **kw).encode(obj)
2025-08-20T19:30:54.0712910Z     |           ^^^^^^^^^^^
2025-08-20T19:30:54.0713473Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 200, in encode
2025-08-20T19:30:54.0714136Z     |     chunks = self.iterencode(o, _one_shot=True)
2025-08-20T19:30:54.0714523Z     |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0715160Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 258, in iterencode
2025-08-20T19:30:54.0715870Z     |     return _iterencode(o, 0)
2025-08-20T19:30:54.0716192Z     |            ^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0716965Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 180, in default
2025-08-20T19:30:54.0717702Z     |     raise TypeError(f'Object of type {o.__class__.__name__} '
2025-08-20T19:30:54.0718237Z     | TypeError: Object of type bytes is not JSON serializable
2025-08-20T19:30:54.0718679Z     +------------------------------------
2025-08-20T19:30:54.0719043Z 
2025-08-20T19:30:54.0719283Z During handling of the above exception, another exception occurred:
2025-08-20T19:30:54.0719897Z tests/unit/routers/test_auth.py:103: in test_login_nonexistent_user
2025-08-20T19:30:54.0720383Z     response = client.post(
2025-08-20T19:30:54.0721008Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/testclient.py:633: in post
2025-08-20T19:30:54.0721697Z     return super().post(
2025-08-20T19:30:54.0722269Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/httpx/_client.py:1145: in post
2025-08-20T19:30:54.0722924Z     return self.request(
2025-08-20T19:30:54.0723544Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/testclient.py:516: in request
2025-08-20T19:30:54.0724228Z     return super().request(
2025-08-20T19:30:54.0724825Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/httpx/_client.py:827: in request
2025-08-20T19:30:54.0725619Z     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2025-08-20T19:30:54.0726519Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/httpx/_client.py:914: in send
2025-08-20T19:30:54.0727176Z     response = self._send_handling_auth(
2025-08-20T19:30:54.0727918Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/httpx/_client.py:942: in _send_handling_auth
2025-08-20T19:30:54.0728674Z     response = self._send_handling_redirects(
2025-08-20T19:30:54.0729428Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/httpx/_client.py:979: in _send_handling_redirects
2025-08-20T19:30:54.0730214Z     response = self._send_single_request(request)
2025-08-20T19:30:54.0730952Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/httpx/_client.py:1015: in _send_single_request
2025-08-20T19:30:54.0731711Z     response = transport.handle_request(request)
2025-08-20T19:30:54.0732455Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/testclient.py:398: in handle_request
2025-08-20T19:30:54.0733172Z     raise exc
2025-08-20T19:30:54.0733772Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/testclient.py:395: in handle_request
2025-08-20T19:30:54.0734519Z     portal.call(self.app, scope, receive, send)
2025-08-20T19:30:54.0735196Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anyio/from_thread.py:291: in call
2025-08-20T19:30:54.0736152Z     return cast(T_Retval, self.start_task_soon(func, *args).result())
2025-08-20T19:30:54.0737233Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/concurrent/futures/_base.py:456: in result
2025-08-20T19:30:54.0737876Z     return self.__get_result()
2025-08-20T19:30:54.0738503Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/concurrent/futures/_base.py:401: in __get_result
2025-08-20T19:30:54.0739156Z     raise self._exception
2025-08-20T19:30:54.0739771Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anyio/from_thread.py:222: in _call_func
2025-08-20T19:30:54.0740462Z     retval = await retval_or_awaitable
2025-08-20T19:30:54.0741155Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/fastapi/applications.py:1054: in __call__
2025-08-20T19:30:54.0741879Z     await super().__call__(scope, receive, send)
2025-08-20T19:30:54.0742597Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/applications.py:123: in __call__
2025-08-20T19:30:54.0743356Z     await self.middleware_stack(scope, receive, send)
2025-08-20T19:30:54.0744155Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/errors.py:186: in __call__
2025-08-20T19:30:54.0744852Z     raise exc
2025-08-20T19:30:54.0745494Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/errors.py:164: in __call__
2025-08-20T19:30:54.0746255Z     await self.app(scope, receive, _send)
2025-08-20T19:30:54.0747124Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/cors.py:85: in __call__
2025-08-20T19:30:54.0747865Z     await self.app(scope, receive, send)
2025-08-20T19:30:54.0748572Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py:189: in __call__
2025-08-20T19:30:54.0749314Z     with collapse_excgroups():
2025-08-20T19:30:54.0749843Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/contextlib.py:158: in __exit__
2025-08-20T19:30:54.0750441Z     self.gen.throw(typ, value, traceback)
2025-08-20T19:30:54.0751166Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py:93: in collapse_excgroups
2025-08-20T19:30:54.0751877Z     raise exc
2025-08-20T19:30:54.0752502Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py:191: in __call__
2025-08-20T19:30:54.0753291Z     response = await self.dispatch_func(request, call_next)
2025-08-20T19:30:54.0753733Z app/main.py:88: in dispatch
2025-08-20T19:30:54.0754047Z     response = await call_next(request)
2025-08-20T19:30:54.0754758Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py:165: in call_next
2025-08-20T19:30:54.0755476Z     raise app_exc
2025-08-20T19:30:54.0756067Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py:151: in coro
2025-08-20T19:30:54.0757015Z     await self.app(scope, receive_or_disconnect, send_no_error)
2025-08-20T19:30:54.0757835Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py:189: in __call__
2025-08-20T19:30:54.0758556Z     with collapse_excgroups():
2025-08-20T19:30:54.0759075Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/contextlib.py:158: in __exit__
2025-08-20T19:30:54.0759662Z     self.gen.throw(typ, value, traceback)
2025-08-20T19:30:54.0760374Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py:93: in collapse_excgroups
2025-08-20T19:30:54.0761061Z     raise exc
2025-08-20T19:30:54.0761664Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py:191: in __call__
2025-08-20T19:30:54.0762432Z     response = await self.dispatch_func(request, call_next)
2025-08-20T19:30:54.0762857Z app/main.py:138: in dispatch
2025-08-20T19:30:54.0763169Z     response = await call_next(request)
2025-08-20T19:30:54.0764071Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py:165: in call_next
2025-08-20T19:30:54.0764947Z     raise app_exc
2025-08-20T19:30:54.0765542Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py:151: in coro
2025-08-20T19:30:54.0766313Z     await self.app(scope, receive_or_disconnect, send_no_error)
2025-08-20T19:30:54.0767271Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/exceptions.py:65: in __call__
2025-08-20T19:30:54.0768187Z     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-08-20T19:30:54.0769089Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py:64: in wrapped_app
2025-08-20T19:30:54.0769805Z     raise exc
2025-08-20T19:30:54.0770443Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-08-20T19:30:54.0771210Z     await app(scope, receive, sender)
2025-08-20T19:30:54.0771879Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py:756: in __call__
2025-08-20T19:30:54.0772618Z     await self.middleware_stack(scope, receive, send)
2025-08-20T19:30:54.0773308Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py:776: in app
2025-08-20T19:30:54.0773994Z     await route.handle(scope, receive, send)
2025-08-20T19:30:54.0774691Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py:297: in handle
2025-08-20T19:30:54.0775379Z     await self.app(scope, receive, send)
2025-08-20T19:30:54.0776008Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py:77: in app
2025-08-20T19:30:54.0776933Z     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-08-20T19:30:54.0777816Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py:75: in wrapped_app
2025-08-20T19:30:54.0778595Z     response = await handler(conn, exc)
2025-08-20T19:30:54.0778998Z app/main.py:179: in validation_exception_handler
2025-08-20T19:30:54.0779387Z     response = JSONResponse(
2025-08-20T19:30:54.0780033Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py:184: in __init__
2025-08-20T19:30:54.0780839Z     super().__init__(content, status_code, headers, media_type, background)
2025-08-20T19:30:54.0781638Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py:41: in __init__
2025-08-20T19:30:54.0782336Z     self.body = self.render(content)
2025-08-20T19:30:54.0783005Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py:187: in render
2025-08-20T19:30:54.0783672Z     return json.dumps(
2025-08-20T19:30:54.0784172Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/__init__.py:238: in dumps
2025-08-20T19:30:54.0784730Z     **kw).encode(obj)
2025-08-20T19:30:54.0785212Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py:200: in encode
2025-08-20T19:30:54.0785846Z     chunks = self.iterencode(o, _one_shot=True)
2025-08-20T19:30:54.0786636Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py:258: in iterencode
2025-08-20T19:30:54.0787228Z     return _iterencode(o, 0)
2025-08-20T19:30:54.0787768Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py:180: in default
2025-08-20T19:30:54.0788408Z     raise TypeError(f'Object of type {o.__class__.__name__} '
2025-08-20T19:30:54.0788931Z E   TypeError: Object of type bytes is not JSON serializable
2025-08-20T19:30:54.0789500Z ------------------------------ Captured log setup ------------------------------
2025-08-20T19:30:54.0790325Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table prices does not exist, skipping index idx_price_asset_date
2025-08-20T19:30:54.0791353Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table prices does not exist, skipping index idx_price_date
2025-08-20T19:30:54.0792526Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table prices does not exist, skipping index idx_price_asset_id
2025-08-20T19:30:54.0793745Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table allocations does not exist, skipping index idx_allocation_date
2025-08-20T19:30:54.0794868Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table allocations does not exist, skipping index idx_allocation_asset_date
2025-08-20T19:30:54.0795976Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table index_values does not exist, skipping index idx_index_value_date
2025-08-20T19:30:54.0797351Z ERROR    app.utils.run_migrations:run_migrations.py:169 Google auth migration failed: (psycopg2.errors.UndefinedTable) relation "users" does not exist
2025-08-20T19:30:54.0798078Z 
2025-08-20T19:30:54.0798169Z [SQL: 
2025-08-20T19:30:54.0798408Z                 ALTER TABLE users 
2025-08-20T19:30:54.0798788Z                 ADD COLUMN is_google_user BOOLEAN DEFAULT FALSE
2025-08-20T19:30:54.0799175Z             ]
2025-08-20T19:30:54.0799546Z (Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-20T19:30:54.0800191Z ERROR    app.utils.run_migrations:run_migrations.py:188 Migration google_auth failed
2025-08-20T19:30:54.0800896Z WARNING  app.main:main.py:45 Some database migrations failed - check logs
2025-08-20T19:30:54.0801482Z ------------------------------ Captured log call -------------------------------
2025-08-20T19:30:54.0802170Z ERROR    app.main:main.py:188 Unhandled exception: Object of type bytes is not JSON serializable
2025-08-20T19:30:54.0802818Z   + Exception Group Traceback (most recent call last):
2025-08-20T19:30:54.0803654Z   |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py", line 87, in collapse_excgroups
2025-08-20T19:30:54.0804417Z   |     yield
2025-08-20T19:30:54.0805088Z   |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 190, in __call__
2025-08-20T19:30:54.0805939Z   |     async with anyio.create_task_group() as task_group:
2025-08-20T19:30:54.0806961Z   |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
2025-08-20T19:30:54.0807750Z   |     raise BaseExceptionGroup(
2025-08-20T19:30:54.0808228Z   | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
2025-08-20T19:30:54.0808700Z   +-+---------------- 1 ----------------
2025-08-20T19:30:54.0809057Z     | Traceback (most recent call last):
2025-08-20T19:30:54.0809843Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
2025-08-20T19:30:54.0810685Z     |     await self.app(scope, receive, _send)
2025-08-20T19:30:54.0811484Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/cors.py", line 85, in __call__
2025-08-20T19:30:54.0812293Z     |     await self.app(scope, receive, send)
2025-08-20T19:30:54.0813102Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
2025-08-20T19:30:54.0813905Z     |     with collapse_excgroups():
2025-08-20T19:30:54.0814512Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/contextlib.py", line 158, in __exit__
2025-08-20T19:30:54.0815139Z     |     self.gen.throw(typ, value, traceback)
2025-08-20T19:30:54.0815967Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
2025-08-20T19:30:54.0816862Z     |     raise exc
2025-08-20T19:30:54.0817539Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
2025-08-20T19:30:54.0818389Z     |     response = await self.dispatch_func(request, call_next)
2025-08-20T19:30:54.0818819Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0819607Z     |   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 88, in dispatch
2025-08-20T19:30:54.0820384Z     |     response = await call_next(request)
2025-08-20T19:30:54.0820746Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0821534Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
2025-08-20T19:30:54.0822312Z     |     raise app_exc
2025-08-20T19:30:54.0823006Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
2025-08-20T19:30:54.0823853Z     |     await self.app(scope, receive_or_disconnect, send_no_error)
2025-08-20T19:30:54.0824722Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
2025-08-20T19:30:54.0825505Z     |     with collapse_excgroups():
2025-08-20T19:30:54.0826125Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/contextlib.py", line 158, in __exit__
2025-08-20T19:30:54.0826934Z     |     self.gen.throw(typ, value, traceback)
2025-08-20T19:30:54.0827730Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
2025-08-20T19:30:54.0828483Z     |     raise exc
2025-08-20T19:30:54.0829165Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
2025-08-20T19:30:54.0830009Z     |     response = await self.dispatch_func(request, call_next)
2025-08-20T19:30:54.0830439Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0831061Z     |   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 138, in dispatch
2025-08-20T19:30:54.0831703Z     |     response = await call_next(request)
2025-08-20T19:30:54.0832071Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0832821Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
2025-08-20T19:30:54.0833597Z     |     raise app_exc
2025-08-20T19:30:54.0834265Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
2025-08-20T19:30:54.0835116Z     |     await self.app(scope, receive_or_disconnect, send_no_error)
2025-08-20T19:30:54.0836029Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 65, in __call__
2025-08-20T19:30:54.0837181Z     |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-08-20T19:30:54.0838153Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
2025-08-20T19:30:54.0838951Z     |     raise exc
2025-08-20T19:30:54.0839661Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
2025-08-20T19:30:54.0840489Z     |     await app(scope, receive, sender)
2025-08-20T19:30:54.0841232Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 756, in __call__
2025-08-20T19:30:54.0842027Z     |     await self.middleware_stack(scope, receive, send)
2025-08-20T19:30:54.0842796Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 776, in app
2025-08-20T19:30:54.0843582Z     |     await route.handle(scope, receive, send)
2025-08-20T19:30:54.0844338Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 297, in handle
2025-08-20T19:30:54.0845116Z     |     await self.app(scope, receive, send)
2025-08-20T19:30:54.0845849Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 77, in app
2025-08-20T19:30:54.0847168Z     |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-08-20T19:30:54.0848148Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 75, in wrapped_app
2025-08-20T19:30:54.0848985Z     |     response = await handler(conn, exc)
2025-08-20T19:30:54.0849361Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0850082Z     |   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 179, in validation_exception_handler
2025-08-20T19:30:54.0850821Z     |     response = JSONResponse(
2025-08-20T19:30:54.0851144Z     |                ^^^^^^^^^^^^^
2025-08-20T19:30:54.0851843Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 184, in __init__
2025-08-20T19:30:54.0852724Z     |     super().__init__(content, status_code, headers, media_type, background)
2025-08-20T19:30:54.0853588Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 41, in __init__
2025-08-20T19:30:54.0854373Z     |     self.body = self.render(content)
2025-08-20T19:30:54.0854729Z     |                 ^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0855448Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 187, in render
2025-08-20T19:30:54.0856183Z     |     return json.dumps(
2025-08-20T19:30:54.0856620Z     |            ^^^^^^^^^^^
2025-08-20T19:30:54.0857185Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/__init__.py", line 238, in dumps
2025-08-20T19:30:54.0857786Z     |     **kw).encode(obj)
2025-08-20T19:30:54.0858060Z     |           ^^^^^^^^^^^
2025-08-20T19:30:54.0858603Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 200, in encode
2025-08-20T19:30:54.0859258Z     |     chunks = self.iterencode(o, _one_shot=True)
2025-08-20T19:30:54.0859651Z     |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0860285Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 258, in iterencode
2025-08-20T19:30:54.0860942Z     |     return _iterencode(o, 0)
2025-08-20T19:30:54.0861273Z     |            ^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0861846Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 180, in default
2025-08-20T19:30:54.0862548Z     |     raise TypeError(f'Object of type {o.__class__.__name__} '
2025-08-20T19:30:54.0863053Z     | TypeError: Object of type bytes is not JSON serializable
2025-08-20T19:30:54.0863483Z     +------------------------------------
2025-08-20T19:30:54.0863712Z 
2025-08-20T19:30:54.0863954Z During handling of the above exception, another exception occurred:
2025-08-20T19:30:54.0864314Z 
2025-08-20T19:30:54.0864438Z Traceback (most recent call last):
2025-08-20T19:30:54.0872131Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
2025-08-20T19:30:54.0873070Z     await self.app(scope, receive, _send)
2025-08-20T19:30:54.0873973Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/cors.py", line 85, in __call__
2025-08-20T19:30:54.0874812Z     await self.app(scope, receive, send)
2025-08-20T19:30:54.0875668Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
2025-08-20T19:30:54.0876715Z     with collapse_excgroups():
2025-08-20T19:30:54.0877337Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/contextlib.py", line 158, in __exit__
2025-08-20T19:30:54.0877804Z     self.gen.throw(typ, value, traceback)
2025-08-20T19:30:54.0878400Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
2025-08-20T19:30:54.0879114Z     raise exc
2025-08-20T19:30:54.0879602Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
2025-08-20T19:30:54.0880295Z     response = await self.dispatch_func(request, call_next)
2025-08-20T19:30:54.0880607Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0881066Z   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 88, in dispatch
2025-08-20T19:30:54.0881489Z     response = await call_next(request)
2025-08-20T19:30:54.0881717Z                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0882250Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
2025-08-20T19:30:54.0882787Z     raise app_exc
2025-08-20T19:30:54.0883257Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
2025-08-20T19:30:54.0883834Z     await self.app(scope, receive_or_disconnect, send_no_error)
2025-08-20T19:30:54.0884439Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
2025-08-20T19:30:54.0884958Z     with collapse_excgroups():
2025-08-20T19:30:54.0885377Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/contextlib.py", line 158, in __exit__
2025-08-20T19:30:54.0885800Z     self.gen.throw(typ, value, traceback)
2025-08-20T19:30:54.0886349Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
2025-08-20T19:30:54.0887021Z     raise exc
2025-08-20T19:30:54.0887490Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
2025-08-20T19:30:54.0888052Z     response = await self.dispatch_func(request, call_next)
2025-08-20T19:30:54.0888336Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0888775Z   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 138, in dispatch
2025-08-20T19:30:54.0889205Z     response = await call_next(request)
2025-08-20T19:30:54.0889426Z                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0889950Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
2025-08-20T19:30:54.0890468Z     raise app_exc
2025-08-20T19:30:54.0890932Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
2025-08-20T19:30:54.0891494Z     await self.app(scope, receive_or_disconnect, send_no_error)
2025-08-20T19:30:54.0892116Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 65, in __call__
2025-08-20T19:30:54.0892750Z     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-08-20T19:30:54.0893407Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
2025-08-20T19:30:54.0893931Z     raise exc
2025-08-20T19:30:54.0894407Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
2025-08-20T19:30:54.0894946Z     await app(scope, receive, sender)
2025-08-20T19:30:54.0895454Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 756, in __call__
2025-08-20T19:30:54.0895972Z     await self.middleware_stack(scope, receive, send)
2025-08-20T19:30:54.0896613Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 776, in app
2025-08-20T19:30:54.0897103Z     await route.handle(scope, receive, send)
2025-08-20T19:30:54.0897612Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 297, in handle
2025-08-20T19:30:54.0898222Z     await self.app(scope, receive, send)
2025-08-20T19:30:54.0898806Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 77, in app
2025-08-20T19:30:54.0899364Z     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-08-20T19:30:54.0900006Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 75, in wrapped_app
2025-08-20T19:30:54.0900540Z     response = await handler(conn, exc)
2025-08-20T19:30:54.0900767Z                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0901260Z   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 179, in validation_exception_handler
2025-08-20T19:30:54.0901741Z     response = JSONResponse(
2025-08-20T19:30:54.0901958Z                ^^^^^^^^^^^^^
2025-08-20T19:30:54.0902467Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 184, in __init__
2025-08-20T19:30:54.0903083Z     super().__init__(content, status_code, headers, media_type, background)
2025-08-20T19:30:54.0903705Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 41, in __init__
2025-08-20T19:30:54.0904202Z     self.body = self.render(content)
2025-08-20T19:30:54.0904427Z                 ^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0904911Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 187, in render
2025-08-20T19:30:54.0905398Z     return json.dumps(
2025-08-20T19:30:54.0905583Z            ^^^^^^^^^^^
2025-08-20T19:30:54.0905956Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/__init__.py", line 238, in dumps
2025-08-20T19:30:54.0906374Z     **kw).encode(obj)
2025-08-20T19:30:54.0906657Z           ^^^^^^^^^^^
2025-08-20T19:30:54.0907051Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 200, in encode
2025-08-20T19:30:54.0907498Z     chunks = self.iterencode(o, _one_shot=True)
2025-08-20T19:30:54.0907753Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0908196Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 258, in iterencode
2025-08-20T19:30:54.0908626Z     return _iterencode(o, 0)
2025-08-20T19:30:54.0908825Z            ^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0909223Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 180, in default
2025-08-20T19:30:54.0909720Z     raise TypeError(f'Object of type {o.__class__.__name__} '
2025-08-20T19:30:54.0910068Z TypeError: Object of type bytes is not JSON serializable
2025-08-20T19:30:54.0910489Z ERROR    app.main:main.py:189 Traceback:   + Exception Group Traceback (most recent call last):
2025-08-20T19:30:54.0911161Z   |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py", line 87, in collapse_excgroups
2025-08-20T19:30:54.0911675Z   |     yield
2025-08-20T19:30:54.0912128Z   |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 190, in __call__
2025-08-20T19:30:54.0912696Z   |     async with anyio.create_task_group() as task_group:
2025-08-20T19:30:54.0913253Z   |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
2025-08-20T19:30:54.0913776Z   |     raise BaseExceptionGroup(
2025-08-20T19:30:54.0914099Z   | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
2025-08-20T19:30:54.0914427Z   +-+---------------- 1 ----------------
2025-08-20T19:30:54.0914669Z     | Traceback (most recent call last):
2025-08-20T19:30:54.0915201Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
2025-08-20T19:30:54.0915814Z     |     await self.app(scope, receive, _send)
2025-08-20T19:30:54.0916606Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/cors.py", line 85, in __call__
2025-08-20T19:30:54.0917249Z     |     await self.app(scope, receive, send)
2025-08-20T19:30:54.0917775Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
2025-08-20T19:30:54.0918287Z     |     with collapse_excgroups():
2025-08-20T19:30:54.0918695Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/contextlib.py", line 158, in __exit__
2025-08-20T19:30:54.0919121Z     |     self.gen.throw(typ, value, traceback)
2025-08-20T19:30:54.0919646Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
2025-08-20T19:30:54.0920150Z     |     raise exc
2025-08-20T19:30:54.0920600Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
2025-08-20T19:30:54.0921173Z     |     response = await self.dispatch_func(request, call_next)
2025-08-20T19:30:54.0921466Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0921886Z     |   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 88, in dispatch
2025-08-20T19:30:54.0922305Z     |     response = await call_next(request)
2025-08-20T19:30:54.0922538Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0923047Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
2025-08-20T19:30:54.0923558Z     |     raise app_exc
2025-08-20T19:30:54.0924018Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
2025-08-20T19:30:54.0924580Z     |     await self.app(scope, receive_or_disconnect, send_no_error)
2025-08-20T19:30:54.0925159Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
2025-08-20T19:30:54.0925687Z     |     with collapse_excgroups():
2025-08-20T19:30:54.0926091Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/contextlib.py", line 158, in __exit__
2025-08-20T19:30:54.0926623Z     |     self.gen.throw(typ, value, traceback)
2025-08-20T19:30:54.0927137Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
2025-08-20T19:30:54.0927636Z     |     raise exc
2025-08-20T19:30:54.0928092Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
2025-08-20T19:30:54.0928660Z     |     response = await self.dispatch_func(request, call_next)
2025-08-20T19:30:54.0928949Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0929367Z     |   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 138, in dispatch
2025-08-20T19:30:54.0929798Z     |     response = await call_next(request)
2025-08-20T19:30:54.0930030Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0930540Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
2025-08-20T19:30:54.0931051Z     |     raise app_exc
2025-08-20T19:30:54.0931502Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
2025-08-20T19:30:54.0932067Z     |     await self.app(scope, receive_or_disconnect, send_no_error)
2025-08-20T19:30:54.0932678Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 65, in __call__
2025-08-20T19:30:54.0933478Z     |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-08-20T19:30:54.0934229Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
2025-08-20T19:30:54.0935218Z     |     raise exc
2025-08-20T19:30:54.0935757Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
2025-08-20T19:30:54.0936519Z     |     await app(scope, receive, sender)
2025-08-20T19:30:54.0937191Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 756, in __call__
2025-08-20T19:30:54.0990269Z     |     await self.middleware_stack(scope, receive, send)
2025-08-20T19:30:54.0991133Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 776, in app
2025-08-20T19:30:54.0991921Z     |     await route.handle(scope, receive, send)
2025-08-20T19:30:54.0992746Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 297, in handle
2025-08-20T19:30:54.0993514Z     |     await self.app(scope, receive, send)
2025-08-20T19:30:54.0994310Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 77, in app
2025-08-20T19:30:54.0995286Z     |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-08-20T19:30:54.0996592Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 75, in wrapped_app
2025-08-20T19:30:54.0997599Z     |     response = await handler(conn, exc)
2025-08-20T19:30:54.0998038Z     |                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.0998886Z     |   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 179, in validation_exception_handler
2025-08-20T19:30:54.0999668Z     |     response = JSONResponse(
2025-08-20T19:30:54.0999907Z     |                ^^^^^^^^^^^^^
2025-08-20T19:30:54.1000416Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 184, in __init__
2025-08-20T19:30:54.1001039Z     |     super().__init__(content, status_code, headers, media_type, background)
2025-08-20T19:30:54.1001632Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 41, in __init__
2025-08-20T19:30:54.1002125Z     |     self.body = self.render(content)
2025-08-20T19:30:54.1002358Z     |                 ^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.1002832Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 187, in render
2025-08-20T19:30:54.1003310Z     |     return json.dumps(
2025-08-20T19:30:54.1003513Z     |            ^^^^^^^^^^^
2025-08-20T19:30:54.1003890Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/__init__.py", line 238, in dumps
2025-08-20T19:30:54.1004300Z     |     **kw).encode(obj)
2025-08-20T19:30:54.1004491Z     |           ^^^^^^^^^^^
2025-08-20T19:30:54.1004860Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 200, in encode
2025-08-20T19:30:54.1005297Z     |     chunks = self.iterencode(o, _one_shot=True)
2025-08-20T19:30:54.1005562Z     |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.1005999Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 258, in iterencode
2025-08-20T19:30:54.1006614Z     |     return _iterencode(o, 0)
2025-08-20T19:30:54.1006850Z     |            ^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.1007244Z     |   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 180, in default
2025-08-20T19:30:54.1007723Z     |     raise TypeError(f'Object of type {o.__class__.__name__} '
2025-08-20T19:30:54.1008080Z     | TypeError: Object of type bytes is not JSON serializable
2025-08-20T19:30:54.1008372Z     +------------------------------------
2025-08-20T19:30:54.1008537Z 
2025-08-20T19:30:54.1008916Z During handling of the above exception, another exception occurred:
2025-08-20T19:30:54.1009276Z 
2025-08-20T19:30:54.1009366Z Traceback (most recent call last):
2025-08-20T19:30:54.1010015Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
2025-08-20T19:30:54.1010595Z     await self.app(scope, receive, _send)
2025-08-20T19:30:54.1011153Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/cors.py", line 85, in __call__
2025-08-20T19:30:54.1011687Z     await self.app(scope, receive, send)
2025-08-20T19:30:54.1012239Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
2025-08-20T19:30:54.1012765Z     with collapse_excgroups():
2025-08-20T19:30:54.1013189Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/contextlib.py", line 158, in __exit__
2025-08-20T19:30:54.1013626Z     self.gen.throw(typ, value, traceback)
2025-08-20T19:30:54.1014172Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
2025-08-20T19:30:54.1014685Z     raise exc
2025-08-20T19:30:54.1015161Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
2025-08-20T19:30:54.1015776Z     response = await self.dispatch_func(request, call_next)
2025-08-20T19:30:54.1016073Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.1016686Z   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 88, in dispatch
2025-08-20T19:30:54.1017126Z     response = await call_next(request)
2025-08-20T19:30:54.1017365Z                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.1017889Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
2025-08-20T19:30:54.1018416Z     raise app_exc
2025-08-20T19:30:54.1018882Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
2025-08-20T19:30:54.1019457Z     await self.app(scope, receive_or_disconnect, send_no_error)
2025-08-20T19:30:54.1020053Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
2025-08-20T19:30:54.1020573Z     with collapse_excgroups():
2025-08-20T19:30:54.1020995Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/contextlib.py", line 158, in __exit__
2025-08-20T19:30:54.1021425Z     self.gen.throw(typ, value, traceback)
2025-08-20T19:30:54.1021964Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
2025-08-20T19:30:54.1022464Z     raise exc
2025-08-20T19:30:54.1022929Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
2025-08-20T19:30:54.1023488Z     response = await self.dispatch_func(request, call_next)
2025-08-20T19:30:54.1023777Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.1024211Z   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 138, in dispatch
2025-08-20T19:30:54.1024635Z     response = await call_next(request)
2025-08-20T19:30:54.1024864Z                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.1025376Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
2025-08-20T19:30:54.1025886Z     raise app_exc
2025-08-20T19:30:54.1026348Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
2025-08-20T19:30:54.1027061Z     await self.app(scope, receive_or_disconnect, send_no_error)
2025-08-20T19:30:54.1027694Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 65, in __call__
2025-08-20T19:30:54.1028469Z     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-08-20T19:30:54.1029233Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
2025-08-20T19:30:54.1029764Z     raise exc
2025-08-20T19:30:54.1030258Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
2025-08-20T19:30:54.1030815Z     await app(scope, receive, sender)
2025-08-20T19:30:54.1031343Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 756, in __call__
2025-08-20T19:30:54.1031873Z     await self.middleware_stack(scope, receive, send)
2025-08-20T19:30:54.1032401Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 776, in app
2025-08-20T19:30:54.1032910Z     await route.handle(scope, receive, send)
2025-08-20T19:30:54.1033413Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 297, in handle
2025-08-20T19:30:54.1033911Z     await self.app(scope, receive, send)
2025-08-20T19:30:54.1034402Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/routing.py", line 77, in app
2025-08-20T19:30:54.1034960Z     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-08-20T19:30:54.1035608Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/_exception_handler.py", line 75, in wrapped_app
2025-08-20T19:30:54.1036147Z     response = await handler(conn, exc)
2025-08-20T19:30:54.1036503Z                ^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.1037037Z   File "/home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py", line 179, in validation_exception_handler
2025-08-20T19:30:54.1037528Z     response = JSONResponse(
2025-08-20T19:30:54.1037741Z                ^^^^^^^^^^^^^
2025-08-20T19:30:54.1038226Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 184, in __init__
2025-08-20T19:30:54.1038810Z     super().__init__(content, status_code, headers, media_type, background)
2025-08-20T19:30:54.1039405Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 41, in __init__
2025-08-20T19:30:54.1039909Z     self.body = self.render(content)
2025-08-20T19:30:54.1040131Z                 ^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.1040612Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/starlette/responses.py", line 187, in render
2025-08-20T19:30:54.1041087Z     return json.dumps(
2025-08-20T19:30:54.1041275Z            ^^^^^^^^^^^
2025-08-20T19:30:54.1041661Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/__init__.py", line 238, in dumps
2025-08-20T19:30:54.1042065Z     **kw).encode(obj)
2025-08-20T19:30:54.1042244Z           ^^^^^^^^^^^
2025-08-20T19:30:54.1042620Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 200, in encode
2025-08-20T19:30:54.1043063Z     chunks = self.iterencode(o, _one_shot=True)
2025-08-20T19:30:54.1043314Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.1043750Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 258, in iterencode
2025-08-20T19:30:54.1044178Z     return _iterencode(o, 0)
2025-08-20T19:30:54.1044381Z            ^^^^^^^^^^^^^^^^^
2025-08-20T19:30:54.1044768Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/encoder.py", line 180, in default
2025-08-20T19:30:54.1045271Z     raise TypeError(f'Object of type {o.__class__.__name__} '
2025-08-20T19:30:54.1045623Z TypeError: Object of type bytes is not JSON serializable
2025-08-20T19:30:54.1046004Z __________________ TestAuthEndpoints.test_login_inactive_user __________________
2025-08-20T19:30:54.1046703Z tests/unit/routers/test_auth.py:119: in test_login_inactive_user
2025-08-20T19:30:54.1047034Z     inactive_user = User(
2025-08-20T19:30:54.1047349Z <string>:4: in __init__
2025-08-20T19:30:54.1047528Z     ???
2025-08-20T19:30:54.1047966Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/sqlalchemy/orm/state.py:571: in _initialize_instance
2025-08-20T19:30:54.1048468Z     with util.safe_reraise():
2025-08-20T19:30:54.1048942Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py:146: in __exit__
2025-08-20T19:30:54.1049449Z     raise exc_value.with_traceback(exc_tb)
2025-08-20T19:30:54.1049953Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/sqlalchemy/orm/state.py:569: in _initialize_instance
2025-08-20T19:30:54.1050478Z     manager.original_init(*mixed[1:], **kwargs)
2025-08-20T19:30:54.1051023Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py:2167: in _declarative_constructor
2025-08-20T19:30:54.1051559Z     raise TypeError(
2025-08-20T19:30:54.1051827Z E   TypeError: 'username' is an invalid keyword argument for User
2025-08-20T19:30:54.1052208Z ------------------------------ Captured log setup ------------------------------
2025-08-20T19:30:54.1052756Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table prices does not exist, skipping index idx_price_asset_date
2025-08-20T19:30:54.1053427Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table prices does not exist, skipping index idx_price_date
2025-08-20T19:30:54.1054096Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table prices does not exist, skipping index idx_price_asset_id
2025-08-20T19:30:54.1054799Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table allocations does not exist, skipping index idx_allocation_date
2025-08-20T19:30:54.1055529Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table allocations does not exist, skipping index idx_allocation_asset_date
2025-08-20T19:30:54.1056268Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table index_values does not exist, skipping index idx_index_value_date
2025-08-20T19:30:54.1057354Z ERROR    app.utils.run_migrations:run_migrations.py:169 Google auth migration failed: (psycopg2.errors.UndefinedTable) relation "users" does not exist
2025-08-20T19:30:54.1057861Z 
2025-08-20T19:30:54.1057926Z [SQL: 
2025-08-20T19:30:54.1058098Z                 ALTER TABLE users 
2025-08-20T19:30:54.1058358Z                 ADD COLUMN is_google_user BOOLEAN DEFAULT FALSE
2025-08-20T19:30:54.1058622Z             ]
2025-08-20T19:30:54.1058875Z (Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-20T19:30:54.1059308Z ERROR    app.utils.run_migrations:run_migrations.py:188 Migration google_auth failed
2025-08-20T19:30:54.1059764Z WARNING  app.main:main.py:45 Some database migrations failed - check logs
2025-08-20T19:30:54.1060205Z ____________ TestAuthEndpoints.test_get_current_user_expired_token _____________
2025-08-20T19:30:54.1060675Z tests/unit/routers/test_auth.py:165: in test_get_current_user_expired_token
2025-08-20T19:30:54.1061032Z     expired_token = create_access_token(
2025-08-20T19:30:54.1061385Z E   TypeError: create_access_token() got an unexpected keyword argument 'data'
2025-08-20T19:30:54.1061789Z ------------------------------ Captured log setup ------------------------------
2025-08-20T19:30:54.1062328Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table prices does not exist, skipping index idx_price_asset_date
2025-08-20T19:30:54.1062999Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table prices does not exist, skipping index idx_price_date
2025-08-20T19:30:54.1063670Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table prices does not exist, skipping index idx_price_asset_id
2025-08-20T19:30:54.1064370Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table allocations does not exist, skipping index idx_allocation_date
2025-08-20T19:30:54.1065105Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table allocations does not exist, skipping index idx_allocation_asset_date
2025-08-20T19:30:54.1066061Z WARNING  app.utils.run_migrations:run_migrations.py:39 Table index_values does not exist, skipping index idx_index_value_date
2025-08-20T19:30:54.1067043Z ERROR    app.utils.run_migrations:run_migrations.py:169 Google auth migration failed: (psycopg2.errors.UndefinedTable) relation "users" does not exist
2025-08-20T19:30:54.1067532Z 
2025-08-20T19:30:54.1067602Z [SQL: 
2025-08-20T19:30:54.1067775Z                 ALTER TABLE users 
2025-08-20T19:30:54.1068032Z                 ADD COLUMN is_google_user BOOLEAN DEFAULT FALSE
2025-08-20T19:30:54.1068291Z             ]
2025-08-20T19:30:54.1068537Z (Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-20T19:30:54.1068966Z ERROR    app.utils.run_migrations:run_migrations.py:188 Migration google_auth failed
2025-08-20T19:30:54.1069432Z WARNING  app.main:main.py:45 Some database migrations failed - check logs
2025-08-20T19:30:54.1069795Z =============================== warnings summary ===============================
2025-08-20T19:30:54.1070306Z ../../../../../../../opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pydantic/fields.py:826: 19 warnings
2025-08-20T19:30:54.1071773Z   /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pydantic/fields.py:826: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
2025-08-20T19:30:54.1073009Z     warn(
2025-08-20T19:30:54.1073104Z 
2025-08-20T19:30:54.1073451Z ../../../../../../../opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pydantic/_internal/_config.py:291: 10 warnings
2025-08-20T19:30:54.1074837Z   /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pydantic/_internal/_config.py:291: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
2025-08-20T19:30:54.1076025Z     warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-20T19:30:54.1076250Z 
2025-08-20T19:30:54.1076677Z ../../../../../../../opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/passlib/utils/__init__.py:854
2025-08-20T19:30:54.1077567Z   /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
2025-08-20T19:30:54.1078256Z     from crypt import crypt as _crypt
2025-08-20T19:30:54.1078423Z 
2025-08-20T19:30:54.1078692Z ../../../../../../../opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/twelvedata/__init__.py:2
2025-08-20T19:30:54.1079998Z   /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/twelvedata/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-08-20T19:30:54.1081237Z     from pkg_resources import get_distribution, DistributionNotFound
2025-08-20T19:30:54.1081483Z 
2025-08-20T19:30:54.1081773Z ../../../../../../../opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pkg_resources/__init__.py:3146
2025-08-20T19:30:54.1082408Z ../../../../../../../opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pkg_resources/__init__.py:3146
2025-08-20T19:30:54.1083296Z   /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pkg_resources/__init__.py:3146: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
2025-08-20T19:30:54.1084530Z   Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
2025-08-20T19:30:54.1085535Z     declare_namespace(pkg)
2025-08-20T19:30:54.1085678Z 
2025-08-20T19:30:54.1085749Z app/main.py:35
2025-08-20T19:30:54.1086109Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/app/main.py:35: DeprecationWarning: 
2025-08-20T19:30:54.1086748Z           on_event is deprecated, use lifespan event handlers instead.
2025-08-20T19:30:54.1087046Z   
2025-08-20T19:30:54.1087209Z           Read more about it in the
2025-08-20T19:30:54.1087579Z           [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
2025-08-20T19:30:54.1087937Z           
2025-08-20T19:30:54.1088114Z     @app.on_event("startup")
2025-08-20T19:30:54.1088257Z 
2025-08-20T19:30:54.1088542Z ../../../../../../../opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/fastapi/applications.py:4495
2025-08-20T19:30:54.1089255Z   /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/fastapi/applications.py:4495: DeprecationWarning: 
2025-08-20T19:30:54.1089825Z           on_event is deprecated, use lifespan event handlers instead.
2025-08-20T19:30:54.1090106Z   
2025-08-20T19:30:54.1090269Z           Read more about it in the
2025-08-20T19:30:54.1090624Z           [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
2025-08-20T19:30:54.1090987Z           
2025-08-20T19:30:54.1091174Z     return self.router.on_event(event_type)
2025-08-20T19:30:54.1091359Z 
2025-08-20T19:30:54.1091455Z tests/unit/models/test_portfolio.py:13
2025-08-20T19:30:54.1092491Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/models/test_portfolio.py:13: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
2025-08-20T19:30:54.1093495Z     @pytest.mark.unit
2025-08-20T19:30:54.1093631Z 
2025-08-20T19:30:54.1093718Z tests/unit/routers/test_auth.py:16
2025-08-20T19:30:54.1094705Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/routers/test_auth.py:16: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
2025-08-20T19:30:54.1095688Z     @pytest.mark.unit
2025-08-20T19:30:54.1095806Z 
2025-08-20T19:30:54.1095896Z tests/unit/routers/test_auth.py:17
2025-08-20T19:30:54.1097047Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/routers/test_auth.py:17: PytestUnknownMarkWarning: Unknown pytest.mark.critical - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
2025-08-20T19:30:54.1098067Z     @pytest.mark.critical
2025-08-20T19:30:54.1098205Z 
2025-08-20T19:30:54.1098326Z tests/unit/schemas/test_portfolio_schemas.py:16
2025-08-20T19:30:54.1099393Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/schemas/test_portfolio_schemas.py:16: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
2025-08-20T19:30:54.1100429Z     @pytest.mark.unit
2025-08-20T19:30:54.1100551Z 
2025-08-20T19:30:54.1100664Z tests/unit/services/test_return_calculator.py:15
2025-08-20T19:30:54.1101763Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/services/test_return_calculator.py:15: PytestUnknownMarkWarning: Unknown pytest.mark.financial - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
2025-08-20T19:30:54.1102822Z     @pytest.mark.financial
2025-08-20T19:30:54.1102959Z 
2025-08-20T19:30:54.1103069Z tests/unit/services/test_return_calculator.py:16
2025-08-20T19:30:54.1104256Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/services/test_return_calculator.py:16: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
2025-08-20T19:30:54.1105397Z     @pytest.mark.unit
2025-08-20T19:30:54.1105521Z 
2025-08-20T19:30:54.1105629Z tests/unit/services/test_return_calculator.py:17
2025-08-20T19:30:54.1106850Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/services/test_return_calculator.py:17: PytestUnknownMarkWarning: Unknown pytest.mark.critical - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
2025-08-20T19:30:54.1107912Z     @pytest.mark.critical
2025-08-20T19:30:54.1108042Z 
2025-08-20T19:30:54.1108149Z tests/unit/services/test_risk_calculator.py:15
2025-08-20T19:30:54.1109232Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/services/test_risk_calculator.py:15: PytestUnknownMarkWarning: Unknown pytest.mark.financial - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
2025-08-20T19:30:54.1110276Z     @pytest.mark.financial
2025-08-20T19:30:54.1110412Z 
2025-08-20T19:30:54.1110516Z tests/unit/services/test_risk_calculator.py:16
2025-08-20T19:30:54.1111568Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/services/test_risk_calculator.py:16: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
2025-08-20T19:30:54.1112585Z     @pytest.mark.unit
2025-08-20T19:30:54.1112709Z 
2025-08-20T19:30:54.1112812Z tests/unit/services/test_risk_calculator.py:17
2025-08-20T19:30:54.1113874Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/services/test_risk_calculator.py:17: PytestUnknownMarkWarning: Unknown pytest.mark.critical - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
2025-08-20T19:30:54.1114913Z     @pytest.mark.critical
2025-08-20T19:30:54.1115048Z 
2025-08-20T19:30:54.1115160Z tests/unit/services/test_weight_calculator.py:15
2025-08-20T19:30:54.1116272Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/services/test_weight_calculator.py:15: PytestUnknownMarkWarning: Unknown pytest.mark.financial - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
2025-08-20T19:30:54.1117474Z     @pytest.mark.financial
2025-08-20T19:30:54.1117606Z 
2025-08-20T19:30:54.1117720Z tests/unit/services/test_weight_calculator.py:16
2025-08-20T19:30:54.1118774Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/services/test_weight_calculator.py:16: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
2025-08-20T19:30:54.1119808Z     @pytest.mark.unit
2025-08-20T19:30:54.1119924Z 
2025-08-20T19:30:54.1120022Z tests/unit/utils/test_security.py:19
2025-08-20T19:30:54.1121012Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/utils/test_security.py:19: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
2025-08-20T19:30:54.1122004Z     @pytest.mark.unit
2025-08-20T19:30:54.1122118Z 
2025-08-20T19:30:54.1122208Z tests/unit/utils/test_security.py:20
2025-08-20T19:30:54.1123212Z   /home/runner/work/AI-Investment/AI-Investment/apps/api/tests/unit/utils/test_security.py:20: PytestUnknownMarkWarning: Unknown pytest.mark.critical - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
2025-08-20T19:30:54.1124447Z     @pytest.mark.critical
2025-08-20T19:30:54.1124577Z 
2025-08-20T19:30:54.1124759Z -- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
2025-08-20T19:30:54.1125147Z =========================== short test summary info ============================
2025-08-20T19:30:54.1125819Z FAILED tests/unit/models/test_portfolio.py::TestPortfolioModel::test_portfolio_validation_constraints - Failed: DID NOT RAISE <class 'Exception'>
2025-08-20T19:30:54.1126880Z FAILED tests/unit/routers/test_auth.py::TestAuthEndpoints::test_login_nonexistent_user - TypeError: Object of type bytes is not JSON serializable
2025-08-20T19:30:54.1127781Z FAILED tests/unit/routers/test_auth.py::TestAuthEndpoints::test_login_inactive_user - TypeError: 'username' is an invalid keyword argument for User
2025-08-20T19:30:54.1128745Z FAILED tests/unit/routers/test_auth.py::TestAuthEndpoints::test_get_current_user_expired_token - TypeError: create_access_token() got an unexpected keyword argument 'data'
2025-08-20T19:30:54.1129710Z ERROR tests/unit/routers/test_auth.py::TestAuthEndpoints::test_get_current_user - AttributeError: 'Settings' object has no attribute 'ALGORITHM'
2025-08-20T19:30:54.1130317Z !!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 5 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-08-20T19:30:54.1130669Z ============== 4 failed, 15 passed, 49 warnings, 1 error in 4.60s ==============
2025-08-20T19:30:54.3487104Z ##[error]Process completed with exit code 1.
